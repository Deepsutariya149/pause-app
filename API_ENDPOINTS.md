# API Endpoints Verification

## âœ… FULLY VERIFIED & ALIGNED

All mobile app API endpoints have been updated to match the backend NestJS structure.

**Date**: 2025-01-02  
**Status**: âœ… All endpoints verified and working

### Authentication Endpoints âœ…

| Endpoint | Method | Status | Notes |
|----------|--------|--------|-------|
| `/auth/login` | POST | âœ… Working | Returns `{ accessToken, user }` |
| `/auth/register` | POST | âœ… Working | Returns `{ accessToken, user }` |
| `/auth/forgot-password` | POST | âœ… Working | Sends OTP via email |
| `/auth/reset-password` | POST | âœ… Working | Resets with OTP |
| `/auth/logout` | POST | âœ… Working | Blacklists token |
| `/auth/google` | GET | âœ… Working | OAuth flow |
| `/auth/google/callback` | GET | âœ… Working | OAuth callback |

**Important**: Backend returns `accessToken` (camelCase), not `access_token` (snake_case)

### Journal Endpoints âœ…

| Endpoint | Method | Status | Notes |
|----------|--------|--------|-------|
| `/journals` | GET | âœ… Working | Returns `{ journals: [], total: number }` |
| `/journals/:id` | GET | âœ… Working | Returns single journal |
| `/journals` | POST | âœ… Working | Creates journal, auto-analyzes mood |
| `/journals/:id` | PUT | âœ… Working | Updates journal |
| `/journals/:id` | DELETE | âœ… Working | Deletes journal |
| `/journals/upload-voice` | POST | âœ… Working | Upload voice note via multipart |

**Important**: 
- Backend uses `description` (not `content`)
- Backend has optional `mood` field
- AI analysis happens **automatically** - no separate analyze endpoint
- Response includes `aiMoodAnalysis` field

### Mood Endpoints âœ…

| Endpoint | Method | Status | Notes |
|----------|--------|--------|-------|
| `/moods` | GET | âœ… Working | Returns all moods |
| `/moods` | POST | âœ… Working | Creates mood (one per date) |
| `/moods/weekly-summary` | GET | âœ… Working | Weekly summary with distribution |
| `/moods/monthly-summary` | GET | âœ… Working | Monthly summary |
| `/moods/average-score` | GET | âœ… Working | Average mood score |

**Important**:
- Backend uses `moodType` (not `mood`)
- Backend moods: `happy`, `sad`, `anxious`, `neutral`, `angry`, `calm`, `excited`, `tired`
- **No update** or getByDate endpoints - you can only create
- One mood per date (database constraint)

### Exercise Endpoints âœ…

| Endpoint | Method | Status | Notes |
|----------|--------|--------|-------|
| `/exercises` | GET | âœ… Public | Returns active exercises |
| `/exercises/:id` | GET | âœ… Public | Returns single exercise |
| `/exercises` | POST | ğŸ”’ Admin | Create exercise |
| `/exercises/:id` | PUT | ğŸ”’ Admin | Update exercise |
| `/exercises/:id` | DELETE | ğŸ”’ Admin | Delete exercise |
| `/exercises/upload-media` | POST | ğŸ”’ Admin | Upload media |
| `/exercises/admin/all` | GET | ğŸ”’ Admin | All exercises including inactive |

**Important**:
- Backend uses `category` (not `type`)
- Backend uses `mediaUrl` (not `videoUrl`/`audioUrl`)
- Categories: `breathing`, `meditation` (not `mindfulness`)
- **No difficulty** field in backend schema

### User Endpoints âœ…

| Endpoint | Method | Status | Notes |
|----------|--------|--------|-------|
| `/users/profile` | GET | âœ… Working | Returns user profile |
| `/users/profile` | PUT | âœ… Working | Updates profile |
| `/users/account` | DELETE | âœ… Working | Deletes account |

### Request/Response Formats

#### Journal Create/Update
```typescript
// Request
{
  title: string,
  description: string,  // Not "content"
  mood?: 'happy' | 'sad' | 'anxious' | 'neutral',
  date?: string,
  voiceNoteUrl?: string
}

// Response
{
  _id: string,
  userId: string,
  title: string,
  description: string,
  mood: string,
  voiceNoteUrl: string,
  aiMoodAnalysis: string,  // Auto-generated by backend
  date: string,
  createdAt: string,
  updatedAt: string
}
```

#### Mood Create
```typescript
// Request
{
  moodType: 'happy' | 'sad' | 'anxious' | 'neutral' | 'angry' | 'calm' | 'excited' | 'tired',
  date?: string
}

// Response
{
  _id: string,
  userId: string,
  moodType: string,
  date: string,
  createdAt: string
}
```

#### Exercise
```typescript
// Response
{
  _id: string,
  title: string,
  description: string,
  duration: number,
  mediaUrl: string,  // Single mediaUrl (not videoUrl/audioUrl)
  category: 'breathing' | 'meditation',
  isActive: boolean,
  createdAt: string,
  updatedAt: string
}
```

#### User
```typescript
// Response
{
  _id: string,
  name: string,
  email: string,
  avatar?: string,
  gender?: 'male' | 'female' | 'other',
  dateOfBirth?: string,
  role: 'user' | 'admin' | 'superadmin',
  isBanned: boolean,
  isGoogleAuth: boolean,
  isActive: boolean,
  createdAt: string,
  updatedAt: string
}
```

## ğŸ”§ All Fixed

âœ… All endpoints verified
âœ… All request/response types match
âœ… Field names corrected (description, moodType)
âœ… Auto-analysis noted
âœ… Pagination support added
âœ… Auth tokens working
âœ… Comprehensive logging added

## ğŸ“ Current Status

All API endpoints are now correctly aligned with the backend NestJS API!

